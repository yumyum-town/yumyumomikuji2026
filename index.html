<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yumyumé‹å‹¢ãŠã¿ãã˜</title>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --yum-yellow: #FFEB3B;
            --yum-orange: #FF9800;
            --yum-green: #4CAF50;
            --yum-text: #5D4037;
            --yum-white: #FFFFFF;
        }

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif, "Hiragino Sans", "Meiryo", "Apple SD Gothic Neo", "Malgun Gothic", "Microsoft JhengHei";
            background-color: var(--yum-yellow);
            color: var(--yum-text);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* è¨€èªåˆ‡æ›¿ãƒœã‚¿ãƒ³ */
        .lang-selector {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            justify-content: flex-end;
            z-index: 100;
        }

        .lang-btn {
            background: var(--yum-white);
            border: 2px solid var(--yum-orange);
            border-radius: 15px;
            padding: 4px 10px;
            font-size: 0.75rem;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: var(--yum-orange);
            color: white;
        }

        .app-container {
            width: 90%;
            max-width: 450px;
            background-color: var(--yum-white);
            border: 6px solid var(--yum-orange);
            border-radius: 30px;
            padding: 30px 20px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            margin-top: 40px;
        }

        h1 {
            font-size: 1.3rem;
            color: var(--yum-orange);
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .subtitle {
            font-size: 0.9rem;
            background: var(--yum-green);
            color: white;
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .omikuji-asset-container {
            width: 220px;
            height: 220px;
            margin: 20px auto;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            overflow: hidden;
        }

        .omikuji-asset-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .shake { animation: shakeAnim 0.3s infinite; }
        @keyframes shakeAnim {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(8deg) scale(1.05); }
            50% { transform: rotate(0deg) scale(1); }
            75% { transform: rotate(-8deg) scale(1.05); }
            100% { transform: rotate(0deg) scale(1); }
        }

        #draw-btn {
            background-color: var(--yum-orange);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #E65100;
            font-family: inherit;
            transition: all 0.2s;
            margin-top: 10px;
            width: 100%;
        }

        #draw-btn:active { transform: translateY(3px); box-shadow: none; }
        #draw-btn:disabled { background-color: #ccc; box-shadow: none; cursor: not-allowed; }

        #result-area {
            display: none;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .result-title {
            font-size: 1.6rem;
            color: var(--yum-orange);
            margin: 15px 0;
        }

        .char-frame {
            width: 100%;
            height: 250px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .char-frame img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .fortune-text {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 15px;
            padding: 0 10px;
            word-break: break-word;
        }

        .lucky-food-box {
            background-color: #FFF9C4;
            padding: 12px;
            border-radius: 10px;
            border-left: 5px solid var(--yum-green);
            text-align: left;
            margin-bottom: 20px;
        }

        .download-btn {
            display: block;
            background-color: var(--yum-green);
            color: white;
            text-decoration: none;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 4px 0 #2E7D32;
            margin-bottom: 15px;
        }

        .share-message-container {
            background-color: #FFF0F5;
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #FFB6C1;
        }

        .share-message {
            font-size: 0.85rem;
            color: var(--yum-text);
            line-height: 1.5;
            margin: 0;
        }

        .retry-btn {
            background: none;
            border: none;
            color: #888;
            text-decoration: underline;
            cursor: pointer;
            margin-top: 25px;
            font-family: inherit;
        }
    </style>
</head>
<body>

<div class="lang-selector">
    <button class="lang-btn active" onclick="setLanguage('ja')">JP</button>
    <button class="lang-btn" onclick="setLanguage('en')">EN</button>
    <button class="lang-btn" onclick="setLanguage('ko')">KR</button>
    <button class="lang-btn" onclick="setLanguage('zh')">TW</button>
</div>

<div class="app-container">
    <div id="main-view">
        <div class="subtitle" id="ui-main-subtitle">yumyum town ãŠã¿ãã˜</div>
        <h1 id="ui-title">yumyumé‹å‹¢ãŠã¿ãã˜<br>ãƒ¼yumé‹ä¸Šæ˜‡å£ç´™ä»˜ããƒ¼</h1>
        
        <div class="omikuji-asset-container" id="box-container">
            <img id="omikuji-img" src="box.PNG" alt="box">
        </div>
        
        <p id="ui-intro">ä½äººãŸã¡ãŒã‚ãªãŸã®yumé‹ã‚’å ã†ã‚ˆï¼<br>ä¸Šã®ç”»åƒã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã‹ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­ï¼</p>
        <button id="draw-btn">yumé‹ã‚’å ã†ï¼</button>
    </div>

    <div id="result-area">
        <div class="subtitle" id="ui-res-subtitle">ãŠã¿ãã˜çµæœ</div>
        <h2 class="result-title" id="res-name"></h2>
        
        <div class="char-frame">
            <img id="res-img" src="" alt="result">
        </div>

        <p class="fortune-text" id="res-desc"></p>
        
        <div class="lucky-food-box">
            <strong id="ui-lucky-food-label">ğŸ´ ãƒ©ãƒƒã‚­ãƒ¼ãƒ•ãƒ¼ãƒ‰</strong><br>
            <span id="res-food"></span>
        </div>

        <a href="#" id="download-link" class="download-btn" target="_blank">ğŸ å£ç´™ã‚’ã‚²ãƒƒãƒˆã™ã‚‹</a>
        
        <div class="share-message-container">
            <p class="share-message" id="ui-share-msg">Instagramã§ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ãã‚ŒãŸã‚‰<br>ä½äººãŸã¡ãŒã¨ã£ã¦ã‚‚å–œã¶ã‚ˆâœ¨</p>
        </div>

        <button class="retry-btn" id="ui-retry-btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦å¼•ã</button>
    </div>
</div>

<script>
    const i18n = {
        ja: {
            mainSubtitle: "yumyum town ãŠã¿ãã˜",
            title: "yumyumé‹å‹¢ãŠã¿ãã˜<br>ãƒ¼yumé‹ä¸Šæ˜‡å£ç´™ä»˜ããƒ¼",
            intro: "ä½äººãŸã¡ãŒã‚ãªãŸã®yumé‹ã‚’å ã†ã‚ˆï¼<br>ä¸Šã®ç”»åƒã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã‹ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­ï¼",
            drawBtn: "yumé‹ã‚’å ã†ï¼",
            drawing: "å ã„ã¡ã‚…ã†ãƒ»ãƒ»ãƒ»",
            resSubtitle: "ãŠã¿ãã˜çµæœ",
            luckyLabel: "ğŸ´ ãƒ©ãƒƒã‚­ãƒ¼ãƒ•ãƒ¼ãƒ‰",
            download: "ğŸ å£ç´™ã‚’ã‚²ãƒƒãƒˆã™ã‚‹",
            share: "Instagramã§ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ãã‚ŒãŸã‚‰<br>ä½äººãŸã¡ãŒã¨ã£ã¦ã‚‚å–œã¶ã‚ˆâœ¨",
            retry: "ã‚‚ã†ä¸€åº¦å¼•ã"
        },
        en: {
            mainSubtitle: "yumyum town Omikuji",
            title: "yumyum Fortune Omikuji<br>with Lucky Wallpaper",
            intro: "The residents will tell your fortune!<br>Tap the box or the button below!",
            drawBtn: "Draw Fortune!",
            drawing: "Drawing...",
            resSubtitle: "Result",
            luckyLabel: "ğŸ´ Lucky Food",
            download: "ğŸ Get Wallpaper",
            share: "Mention us on Instagram!<br>The residents will be so happyâœ¨",
            retry: "Try Again"
        },
        ko: {
            mainSubtitle: "yumyum town ì˜¤ë¯¸ì¿ ì§€",
            title: "yumyum ìš´ì„¸ ë½‘ê¸°<br>ãƒ¼ìš´ì„¸ ìƒìŠ¹ ë°°ê²½í™”ë©´ í¬í•¨ãƒ¼",
            intro: "ì£¼ë¯¼ë“¤ì´ ë‹¹ì‹ ì˜ ìš´ì„¸ë¥¼ ì ì³ì¤„ê²Œìš”!<br>ìœ„ì˜ ì´ë¯¸ì§€ë¥¼ íƒ­í•˜ê±°ë‚˜ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!",
            drawBtn: "ìš´ì„¸ ì ì¹˜ê¸°!",
            drawing: "ì ì¹˜ëŠ” ì¤‘...",
            resSubtitle: "ê²°ê³¼",
            luckyLabel: "ğŸ´ í–‰ìš´ì˜ ìŒì‹",
            download: "ğŸ ë°°ê²½í™”ë©´ ë°›ê¸°",
            share: "ì¸ìŠ¤íƒ€ê·¸ë¨ì—ì„œ ì–¸ê¸‰í•´ì£¼ì‹œë©´<br>ì£¼ë¯¼ë“¤ì´ ì •ë§ ê¸°ë»í•  ê±°ì˜ˆìš”âœ¨",
            retry: "ë‹¤ì‹œ í•˜ê¸°"
        },
        zh: {
            mainSubtitle: "yumyum town æŠ½ç±¤",
            title: "yumyum é‹å‹¢æŠ½ç±¤<br>ãƒ¼é™„è´ˆé‹å‹¢ä¸Šå‡æ¡Œå¸ƒãƒ¼",
            intro: "å±…æ°‘å€‘æœƒç‚ºä½ å åœé‹å‹¢å“¦ï¼<br>è«‹é»æ“Šä¸Šæ–¹åœ–ç‰‡æˆ–ä¸‹æ–¹æŒ‰éˆ•ï¼",
            drawBtn: "å åœé‹å‹¢ï¼",
            drawing: "å åœä¸­...",
            resSubtitle: "å åœçµæœ",
            luckyLabel: "ğŸ´ å¹¸é‹é£Ÿç‰©",
            download: "ğŸ é ˜å–æ¡Œå¸ƒ",
            share: "åœ¨ Instagram ä¸Šæ¨™è¨˜æˆ‘å€‘çš„è©±<br>å±…æ°‘å€‘æœƒéå¸¸é–‹å¿ƒçš„âœ¨",
            retry: "å†æŠ½ä¸€æ¬¡"
        }
    };

    const fortunes = [
        {
            name: { ja: "ã‚±ãƒãƒ£&ã‚ªãƒ å‰", en: "Kecha&Omu Luck", ko: "Kecha&Omu ê¸¸(å‰)", zh: "Kecha&Omu å‰" },
            desc: { 
                ja: "ãŠæ•£æ­©ã—ãŸã‚Šã€ãµã‚“ã‚ã‚Šç©ºã‚’é£›ã³ãªãŒã‚‰<br>è¡—ã‚’æ•£ç­–ã™ã‚‹ã¨yummyãªå‡ºä¼šã„ãŒã‚ã‚‹ã‹ã‚‚ï¼",
                en: "Take a stroll or fly through the sky.<br>A yummy encounter awaits!",
                ko: "ì‚°ì±…í•˜ê±°ë‚˜ ë‘¥ì‹¤ë‘¥ì‹¤ í•˜ëŠ˜ì„ ë‚ ë©°<br>ë§ˆì„ì„ ì‚°ì±…í•˜ë©´ ë§›ìˆëŠ” ë§Œë‚¨ì´ ìˆì„ì§€ë„!",
                zh: "æ•£æ•£æ­¥æˆ–åœ¨å¤©ç©ºä¸­é£›ç¿”æ¢ç´¢åŸå¸‚ï¼Œ<br>å¯èƒ½æœƒé‡åˆ°ç¾å‘³çš„é‚‚é€…å“¦ï¼"
            },
            food: { ja: "ã‚ªãƒ ãƒ©ã‚¤ã‚¹ã¨ã‚±ãƒãƒ£ãƒƒãƒ—", en: "Omurice and Ketchup", ko: "ì˜¤ë¯€ë¼ì´ìŠ¤ì™€ ì¼€ì²©", zh: "è›‹åŒ…é£¯èˆ‡ç•ªèŒ„é†¬" },
            img: "1kechaomu.JPG",
            wallpaper: "wallpaper1.png",
            weight: 19
        },
        {
            name: { ja: "ãƒœã‚´&ãƒãƒƒãƒ—ã‚¹å‰", en: "Bogoï¼†Chips Luck", ko: "Bogoï¼†Chips ê¸¸(å‰)", zh: "Bogoï¼†Chips å‰" },
            desc: { 
                ja: "ã®ã‚“ã³ã‚Šã™ã‚‹æ™‚é–“ã¨<br>ç´ æ—©ãå‹•ãæ™‚é–“ã‚’æ„è­˜ã™ã‚‹ã¨<br>yummyãªã“ã¨ãŒèµ·ã“ã‚‹ã‹ã‚‚ï¼",
                en: "Balance relaxing and fast-moving time<br>for a yummy day!",
                ko: "ëŠê¸‹í•œ ì‹œê°„ê³¼ ë¹ ë¥´ê²Œ ì›€ì§ì´ëŠ” ì‹œê°„ì„<br>ì˜ì‹í•˜ë©´ ë§›ìˆëŠ” ì¼ì´ ìƒê¸¸ì§€ë„!",
                zh: "æ„è­˜åˆ°æ‚ é–’æ™‚å…‰èˆ‡å¿«é€Ÿè¡Œå‹•æ™‚é–“çš„å¹³è¡¡ï¼Œ<br>å¥½äº‹å°±æœƒç™¼ç”Ÿï¼"
            },
            food: { ja: "ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã¨ãƒ•ãƒ©ã‚¤ãƒ‰ãƒãƒ†ãƒˆ", en: "Burger and Fries", ko: "í–„ë²„ê±°ì™€ ê°ìíŠ€ê¹€", zh: "æ¼¢å ¡èˆ‡ç‚¸è–¯æ¢" },
            img: "2bogochi.JPG",
            wallpaper: "wallpaper2.PNG",
            weight: 19
        },
        {
            name: { ja: "ãƒ›ãƒƒãƒ—&ãƒ—ãƒ‡ã‚£å‰", en: "Hopï¼†Puddi Luck", ko: "Hopï¼†Puddi ê¸¸(å‰)", zh: "Hopï¼†Puddi å‰" },
            desc: { 
                ja: "æ–°ã—ã„ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã‚„ãƒ˜ã‚¢ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è©¦ã—ã¦ã¿ã‚‹ã¨<br>yummyãªæ°—æŒã¡ã«ãªã‚Œã‚‹ã‹ã‚‚ï¼",
                en: "Try new accessories or a hairstyle<br>to feel yummy!",
                ko: "ìƒˆë¡œìš´ ì•¡ì„¸ì„œë¦¬ë‚˜ í—¤ì–´ìŠ¤íƒ€ì¼ì„ ì‹œë„í•´ë³´ë©´<br>ë§›ìˆëŠ” ê¸°ë¶„ì´ ë“¤ì§€ë„!",
                zh: "å˜—è©¦æ–°çš„é…ä»¶æˆ–é«®å‹ï¼Œ<br>å¿ƒæƒ…æœƒè®Šå¾—å¾ˆç¾å‘³ï¼"
            },
            food: { ja: "ç”˜ã„é£²ã¿ç‰©ã¨ãƒ—ãƒªãƒ³", en: "Sweet Drinks and Pudding", ko: "ë‹¬ì½¤í•œ ìŒë£Œì™€ í‘¸ë”©", zh: "ç”œé£²èˆ‡å¸ƒä¸" },
            img: "3hoppuddi.JPG",
            wallpaper: "wallpaper3.png",
            weight: 19
        },
        {
            name: { ja: "ã‚³ã‚³&ãƒ“ãƒ“å‰", en: "Cocoï¼†Bibi Luck", ko: "Cocoï¼†Bibi ê¸¸(å‰)", zh: "Cocoï¼†Bibi å‰" },
            desc: { 
                ja: "ç”˜ã„ã‚‚ã®ã‚’é£Ÿã¹ã¦ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼<br>ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã‚’æ„è­˜ã™ã‚‹ã¨yummyã§ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼ã«ï¼",
                en: "Refresh with sweets!<br>Focus on skincare for a yummy, beauty day.",
                ko: "ë‹¨ ê²ƒì„ ë¨¹ê³  ë¦¬í”„ë ˆì‹œ!<br>ìŠ¤í‚¨ì¼€ì–´ì— ì‹ ê²½ ì“°ë©´ ë§›ìˆê³  ë·°í‹°í•´ì§ˆ ê±°ì•¼!",
                zh: "åƒç”œé£Ÿæ”¾é¬†ä¸€ä¸‹ï¼<br>æ³¨é‡çš®è†šä¿é¤Šæœƒè®Šå¾—ç¾å‘³åˆç¾éº—ï¼"
            },
            food: { ja: "ã‚³ã‚³ã‚¢ã‚¯ãƒƒã‚­ãƒ¼ã¨ãƒŸãƒ«ã‚¯ãƒ“ã‚¹ã‚±ãƒƒãƒˆ", en: "Cocoa Cookies and Milk Biscuits", ko: "ì½”ì½”ì•„ ì¿ í‚¤ì™€ ë°€í¬ ë¹„ã‚¹ã‚±ãƒƒãƒˆ", zh: "å¯å¯é¤…ä¹¾èˆ‡ç‰›å¥¶é¤…ä¹¾" },
            img: "4cocobibi.JPG",
            wallpaper: "wallpaper4.png",
            weight: 19
        },
        {
            name: { ja: "ãƒ›ãƒƒãƒ†ã‚£ãƒ»ãƒ‰ã‚®ã‚£&ã‚¹ãƒ†ã‚´å‰", en: "Hotty-Doggy&Stego Luck", ko: "Hotty-Doggy&Stego ê¸¸(å‰)", zh: "Hotty-Doggy&Stego å‰" },
            desc: { 
                ja: "éŸ³æ¥½ã‚’è´ã„ãŸã‚Šæ­Œã£ãŸã‚Šã™ã‚‹ã¨<br>yummyãªé‹æ°—ãŒã‚¢ãƒƒãƒ—ã™ã‚‹ã‹ã‚‚ï¼",
                en: "Listen to music or sing<br>to boost your yummy luck!",
                ko: "ìŒì•…ì„ ë“£ê±°ë‚˜ ë…¸ë˜ë¥¼ ë¶€ë¥´ë©´<br>ë§›ìˆëŠ” ìš´ì„¸ê°€ ì˜¬ë¼ê°ˆì§€ë„!",
                zh: "è½éŸ³æ¨‚æˆ–å”±æ­Œï¼Œ<br>ç¾å‘³é‹å‹¢æœƒä¸Šå‡å“¦ï¼"
            },
            food: { ja: "ãƒ›ãƒƒãƒˆãƒ‰ãƒƒã‚°ã¨ãƒ­ãƒ¼ãƒ«ãƒ‘ãƒ³", en: "Hot Dogs and Rolls", ko: "í•«ë„ê·¸ì™€ ë¡¤ë¹µ", zh: "ç†±ç‹—èˆ‡é¤åŒ…" },
            img: "5doggyste.JPG",
            wallpaper: "wallpaper5.png",
            weight: 19
        },
        {
            name: { ja: "ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ‰ã‚¥ãƒ¼ãƒ‘ãƒ¼yumyumå‰ï¼", en: "Super Duper yumyum Luck!", ko: "ìŠˆí¼ ë‘í¼ yumyum ê¸¸(å‰)!", zh: "è¶…ç´šç„¡æ•µ yumyum å‰ï¼" },
            desc: { 
                ja: "ä½•ã‚‚ã‹ã‚‚å®Œç’§ï¼é»„é‡‘ã®ã‚±ãƒãƒ£ã¨ã‚ªãƒ ãŒ<br>ãƒãƒãƒ£ãƒ¡ãƒãƒ£ãªå¹¸é‹ã‚’é‹ã‚“ã§ãã¦ãã‚Œã‚‹ã‹ã‚‚ï¼",
                en: "Everything is perfect!<br>Golden Kecha and Omu will bring crazy luck!",
                ko: "ëª¨ë“  ê²ƒì´ ì™„ë²½í•´!<br>í™©ê¸ˆ ì¼€ì°¨ì™€ ì˜¤ë¬´ê°€ ì—„ì²­ë‚œ í–‰ìš´ì„ ê°€ì ¸ë‹¤ì¤„ì§€ë„!",
                zh: "è¬äº‹å®Œç¾ï¼<br>é»ƒé‡‘èŒ„æ±èˆ‡æ­å§†æœƒç‚ºä½ å¸¶ä¾†è¶…ç´šå¹¸é‹ï¼"
            },
            food: { ja: "é»„é‡‘ã®ã‚ªãƒ ãƒ©ã‚¤ã‚¹", en: "Golden Omurice", ko: "í™©ê¸ˆ ì˜¤ë¯€ë¼ì´ìŠ¤", zh: "é»ƒé‡‘è›‹åŒ…é£¯" },
            img: "6supper.JPG",
            wallpaper: "wallpaper6.png",
            weight: 5
        }
    ];

    let currentLang = 'ja';
    let currentResult = null;

    function setLanguage(lang) {
        currentLang = lang;
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            const targetText = lang === 'zh' ? 'TW' : lang === 'ja' ? 'JP' : lang === 'ko' ? 'KR' : 'EN';
            if(btn.innerText === targetText) btn.classList.add('active');
        });

        const t = i18n[lang];
        // å„è¦ç´ ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
        document.getElementById('ui-main-subtitle').innerText = t.mainSubtitle;
        document.getElementById('ui-title').innerHTML = t.title;
        document.getElementById('ui-intro').innerHTML = t.intro;
        document.getElementById('draw-btn').innerText = t.drawBtn;
        document.getElementById('ui-res-subtitle').innerText = t.resSubtitle;
        document.getElementById('ui-lucky-food-label').innerHTML = t.luckyLabel;
        document.getElementById('download-link').innerText = t.download;
        document.getElementById('ui-share-msg').innerHTML = t.share;
        document.getElementById('ui-retry-btn').innerText = t.retry;

        if (currentResult) updateResultTexts();
    }

    function updateResultTexts() {
        document.getElementById('res-name').innerHTML = currentResult.name[currentLang];
        document.getElementById('res-desc').innerHTML = currentResult.desc[currentLang];
        document.getElementById('res-food').innerHTML = currentResult.food[currentLang];
    }

    function startDrawing() {
        const btn = document.getElementById('draw-btn');
        const boxImg = document.getElementById('omikuji-img');
        if(btn.disabled) return;

        boxImg.classList.add('shake');
        btn.disabled = true;
        btn.innerText = i18n[currentLang].drawing;

        setTimeout(() => {
            currentResult = getWeightedResult();
            showResult(currentResult);
        }, 2000); 
    }

    function getWeightedResult() {
        const totalWeight = fortunes.reduce((sum, f) => sum + f.weight, 0);
        let random = Math.random() * totalWeight;
        for (const fortune of fortunes) {
            if (random < fortune.weight) return fortune;
            random -= fortune.weight;
        }
        return fortunes[0];
    }

    function showResult(res) {
        document.getElementById('main-view').style.display = 'none';
        document.getElementById('result-area').style.display = 'block';
        updateResultTexts();
        document.getElementById('res-img').src = res.img;
        document.getElementById('download-link').href = res.wallpaper;
    }

    document.getElementById('draw-btn').addEventListener('click', startDrawing);
    document.getElementById('box-container').addEventListener('click', startDrawing);
</script>

</body>
</html>
